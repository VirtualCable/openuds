<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>uds.core.ui.UserInterface &mdash; UDS 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="UDS 1.0 documentation" href="../../../../index.html" />
    <link rel="up" title="uds.core" href="../../core.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">UDS 1.0 documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../core.html" accesskey="U">uds.core</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for uds.core.ui.UserInterface</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="c">#</span>
<span class="c"># Copyright (c) 2012 Virtual Cable S.L.</span>
<span class="c"># All rights reserved.</span>
<span class="c">#</span>
<span class="c"># Redistribution and use in source and binary forms, with or without modification,</span>
<span class="c"># are permitted provided that the following conditions are met:</span>
<span class="c">#</span>
<span class="c">#    * Redistributions of source code must retain the above copyright notice,</span>
<span class="c">#      this list of conditions and the following disclaimer.</span>
<span class="c">#    * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c">#      this list of conditions and the following disclaimer in the documentation</span>
<span class="c">#      and/or other materials provided with the distribution.</span>
<span class="c">#    * Neither the name of Virtual Cable S.L. nor the names of its contributors</span>
<span class="c">#      may be used to endorse or promote products derived from this software</span>
<span class="c">#      without specific prior written permission.</span>
<span class="c">#</span>
<span class="c"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">.. moduleauthor:: Adolfo Gómez, dkmaster at dkmon dot com</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>

<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">get_language</span><span class="p">,</span> <span class="n">ugettext</span> <span class="k">as</span> <span class="n">_</span>
<span class="kn">import</span> <span class="nn">cPickle</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="gui"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui">[docs]</a><span class="k">class</span> <span class="nc">gui</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class contains the representations of fields needed by UDS modules and</span>
<span class="sd">    administation interface.</span>

<span class="sd">    This contains fields types, that modules uses to make a form and interact</span>
<span class="sd">    with users.</span>

<span class="sd">    The use of this provided fields are as follows:</span>

<span class="sd">    The Module is descendant of &quot;BaseModule&quot;, which also is inherited from this</span>
<span class="sd">    class.</span>

<span class="sd">    At class level, we declare the fields needed to interact with the user, as</span>
<span class="sd">    this example:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">       class AuthModule(Authenticator):</span>
<span class="sd">           # ...</span>
<span class="sd">           # Other initializations</span>
<span class="sd">           # ...</span>
<span class="sd">           users = gui.EditableList(label = &#39;Users&#39;, tooltip = &#39;Select users&#39;,</span>
<span class="sd">               order = 1, values = [&#39;user1&#39;, &#39;user2&#39;, &#39;user3&#39;, &#39;user4&#39;])</span>
<span class="sd">           passw = gui.Password(label=&#39;Pass&#39;, length=32, tooltip=&#39;Password&#39;,</span>
<span class="sd">               order = 2, required = True, defValue = &#39;12345&#39;)</span>
<span class="sd">           # ...</span>
<span class="sd">           # more fields</span>
<span class="sd">           # ...</span>

<span class="sd">    At class instantiation, this data is extracted and processed, so the admin</span>
<span class="sd">    can access this form to let users</span>
<span class="sd">    create new instances of this module.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c"># : True string value</span>
    <span class="n">TRUE</span> <span class="o">=</span> <span class="s">&#39;true&#39;</span>
    <span class="c"># : False string value</span>
    <span class="n">FALSE</span> <span class="o">=</span> <span class="s">&#39;false&#39;</span>

    <span class="c"># : Static Callbacks simple registry</span>
    <span class="n">callbacks</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c"># Helpers</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">convertToChoices</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Helper to convert from array of strings to the same dict used in choice,</span>
<span class="sd">        multichoice, ..</span>
<span class="sd">        The id is set to values in the array (strings), while text is left empty.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">convertToList</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">vals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">unicode</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">choiceItem</span><span class="p">(</span><span class="n">id_</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Helper method to create a single choice item.</span>

<span class="sd">        Args:</span>
<span class="sd">            id: Id of the choice to create</span>

<span class="sd">            text: Text to assign to the choice to create</span>

<span class="sd">        Returns:</span>
<span class="sd">            An dictionary, that is the representation of a single choice item,</span>
<span class="sd">            with 2 keys, &#39;id&#39; and &#39;text&#39;</span>

<span class="sd">        :note: Text can be anything, the method converts it first to text before</span>
<span class="sd">        assigning to dictionary</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">id_</span><span class="p">),</span> <span class="s">&#39;text&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">)}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">strToBool</span><span class="p">(</span><span class="n">str_</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Converts the string &quot;true&quot; (case insensitive) to True (boolean).</span>
<span class="sd">        Anything else is converted to false</span>

<span class="sd">        Args:</span>
<span class="sd">            str: Str to convert to boolean</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the string is &quot;true&quot; (case insensitive), False else.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">str_</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">str_</span>
        <span class="k">if</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">str_</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">gui</span><span class="o">.</span><span class="n">TRUE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">boolToStr</span><span class="p">(</span><span class="n">bol</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Converts a boolean to the string representation. True is converted to</span>
<span class="sd">        &quot;true&quot;, False to &quot;false&quot;.</span>

<span class="sd">        Args:</span>
<span class="sd">            bol: Boolean value (True or false) to convert</span>

<span class="sd">        Returns:</span>
<span class="sd">            &quot;true&quot; if bol evals to True, &quot;false&quot; if don&#39;t.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">bol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gui</span><span class="o">.</span><span class="n">TRUE</span>
        <span class="k">return</span> <span class="n">gui</span><span class="o">.</span><span class="n">FALSE</span>

    <span class="c"># Classes</span>

<div class="viewcode-block" id="gui.InputField"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.InputField">[docs]</a>    <span class="k">class</span> <span class="nc">InputField</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Class representing an simple input field.</span>
<span class="sd">        This class is not directly usable, must be used by any inherited class</span>
<span class="sd">        (fields all of them)</span>
<span class="sd">        All fields are inherited from this one</span>

<span class="sd">        The data managed for an input field, and their default values are:</span>
<span class="sd">            * length: Max length of the field. Defaults to DEFAULT_LENGTH</span>
<span class="sd">            * required: If this field is a MUST. defaults to false</span>
<span class="sd">            * label: Label used with this field. Defaults to &#39;&#39;</span>
<span class="sd">            * defvalue: Default value for the field. Defaults to &#39;&#39; (this is</span>
<span class="sd">              always an string)</span>
<span class="sd">            * rdonly: If the field is read only on modification. On creation,</span>
<span class="sd">              all fields are &quot;writable&quot;. Defaults to False</span>
<span class="sd">            * order: order inside the form, defaults to 0 (if two or more fields</span>
<span class="sd">              has same order, the output order may be anything)</span>
<span class="sd">            * tooltip: Tooltip used in the form, defaults to &#39;&#39;</span>
<span class="sd">            * type: type of the input field, defaults to &quot;text box&quot; (TextField)</span>

<span class="sd">        In every single field, you must at least indicate:</span>
<span class="sd">            * if required or not</span>
<span class="sd">            * order</span>
<span class="sd">            * label</span>
<span class="sd">            * tooltip</span>
<span class="sd">            * defvalue</span>
<span class="sd">            * rdonly if can&#39;t be modified once it&#39;s created</span>

<span class="sd">        Any other paremeter needed is indicated in the corresponding field class.</span>

<span class="sd">        Also a value field is available, so you can get/set the form field value.</span>
<span class="sd">        This property expects always an string, no matter what kind of field it is.</span>

<span class="sd">        Take into account also that &quot;value&quot; has precedence over &quot;defValue&quot;,</span>
<span class="sd">        so if you use both, the used one will be &quot;value&quot;. This is valid for</span>
<span class="sd">        all form fields.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">TEXT_TYPE</span> <span class="o">=</span> <span class="s">&#39;text&#39;</span>
        <span class="n">TEXTBOX_TYPE</span> <span class="o">=</span> <span class="s">&#39;textbox&#39;</span>
        <span class="n">NUMERIC_TYPE</span> <span class="o">=</span> <span class="s">&#39;numeric&#39;</span>
        <span class="n">PASSWORD_TYPE</span> <span class="o">=</span> <span class="s">&#39;password&#39;</span>
        <span class="n">HIDDEN_TYPE</span> <span class="o">=</span> <span class="s">&#39;hidden&#39;</span>
        <span class="n">CHOICE_TYPE</span> <span class="o">=</span> <span class="s">&#39;choice&#39;</span>
        <span class="n">MULTI_CHOICE_TYPE</span> <span class="o">=</span> <span class="s">&#39;multichoice&#39;</span>
        <span class="n">EDITABLE_LIST</span> <span class="o">=</span> <span class="s">&#39;editlist&#39;</span>
        <span class="n">CHECKBOX_TYPE</span> <span class="o">=</span> <span class="s">&#39;checkbox&#39;</span>

        <span class="n">DEFAULT_LENTGH</span> <span class="o">=</span> <span class="mi">32</span>  <span class="c"># : If length of some fields are not especified, this value is used as default</span>

        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&#39;length&#39;</span><span class="p">:</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;length&#39;</span><span class="p">,</span> <span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">DEFAULT_LENTGH</span><span class="p">),</span>
                <span class="s">&#39;required&#39;</span><span class="p">:</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;required&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">),</span>
                <span class="s">&#39;label&#39;</span><span class="p">:</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;label&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span>
                <span class="s">&#39;defvalue&#39;</span><span class="p">:</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;defvalue&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)),</span>
                <span class="s">&#39;rdonly&#39;</span><span class="p">:</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;rdonly&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">),</span>  <span class="c"># This property only affects in &quot;modify&quot; operations</span>
                <span class="s">&#39;order&#39;</span><span class="p">:</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;order&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="s">&#39;tooltip&#39;</span><span class="p">:</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;tooltip&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span>
                <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">TEXT_TYPE</span><span class="p">,</span>
                <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;value&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">),</span>
            <span class="p">}</span>

        <span class="k">def</span> <span class="nf">_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Sets the type of this field.</span>

<span class="sd">            Args:</span>
<span class="sd">                type: Type to set (from constants of this class)</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_</span>

<div class="viewcode-block" id="gui.InputField.isType"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.InputField.isType">[docs]</a>        <span class="k">def</span> <span class="nf">isType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Returns true if this field is of specified type</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">type_</span>
</div>
        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Obtains the stored value</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span>

        <span class="nd">@value.setter</span>
<div class="viewcode-block" id="gui.InputField.value"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.InputField.value">[docs]</a>        <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Stores new value (not the default one)</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</div>
        <span class="k">def</span> <span class="nf">_setValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            So we can override value setting at descendants</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

<div class="viewcode-block" id="gui.InputField.guiDescription"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.InputField.guiDescription">[docs]</a>        <span class="k">def</span> <span class="nf">guiDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Returns the dictionary with the description of this item.</span>
<span class="sd">            We copy it, cause we need to translate the label and tooltip fields</span>
<span class="sd">            and don&#39;t want to</span>
<span class="sd">            alter original values.</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">data</span><span class="p">[</span><span class="s">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;label&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span> <span class="ow">and</span> <span class="n">_</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;label&#39;</span><span class="p">])</span> <span class="ow">or</span> <span class="s">&#39;&#39;</span>
            <span class="n">data</span><span class="p">[</span><span class="s">&#39;tooltip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;tooltip&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span> <span class="ow">and</span> <span class="n">_</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;tooltip&#39;</span><span class="p">])</span> <span class="ow">or</span> <span class="s">&#39;&#39;</span>
            <span class="k">return</span> <span class="n">data</span>
</div>
        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">defValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Returns the default value for this field</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;defvalue&#39;</span><span class="p">]</span>

        <span class="nd">@defValue.setter</span>
<div class="viewcode-block" id="gui.InputField.defValue"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.InputField.defValue">[docs]</a>        <span class="k">def</span> <span class="nf">defValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">defValue</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setDefValue</span><span class="p">(</span><span class="n">defValue</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="gui.InputField.setDefValue"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.InputField.setDefValue">[docs]</a>        <span class="k">def</span> <span class="nf">setDefValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">defValue</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Sets the default value of the field·</span>

<span class="sd">            Args:</span>
<span class="sd">                defValue: Default value (string)</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;defvalue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">defValue</span>
</div>
        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;label&#39;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="gui.TextField"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.TextField">[docs]</a>    <span class="k">class</span> <span class="nc">TextField</span><span class="p">(</span><span class="n">InputField</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This represents a text field.</span>

<span class="sd">        The values of parameters are inherited from :py:class:`InputField`</span>

<span class="sd">        Additionally to standard parameters, the length parameter is a</span>
<span class="sd">        recommended one for this kind of field.</span>

<span class="sd">        You can specify that this is a multiline text box with **multiline**</span>
<span class="sd">        parameter. If it exists, and is greater than 1, indicates how much</span>
<span class="sd">        lines will be used to display field. (Max number is 8)</span>

<span class="sd">        Example usage:</span>

<span class="sd">           .. code-block:: python</span>

<span class="sd">              # Declares an text form field, with label &quot;Host&quot;, tooltip</span>
<span class="sd">              # &quot;Host name for this module&quot;, that is required,</span>
<span class="sd">              # with max length of 64 chars and order = 1, and is editable</span>
<span class="sd">              # after creation.</span>
<span class="sd">              host = gui.TextField(length=64, label = _(&#39;Host&#39;), order = 1,</span>
<span class="sd">                  tooltip = _(&#39;Host name for this module&#39;), required = True)</span>

<span class="sd">              # Declares an text form field, with label &quot;Other&quot;,</span>
<span class="sd">              # tooltip &quot;Other info&quot;, that is not required, that is not</span>
<span class="sd">              # required and that is not editable after creation.</span>
<span class="sd">              other = gui.TextField(length=64, label = _(&#39;Other&#39;), order = 1,</span>
<span class="sd">                  tooltip = _(&#39;Other info&#39;), rdonly = True)</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">TEXT_TYPE</span><span class="p">)</span>
            <span class="n">multiline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;multiline&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">multiline</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
                <span class="n">multiline</span> <span class="o">=</span> <span class="mi">8</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;multiline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiline</span>
</div>
<div class="viewcode-block" id="gui.NumericField"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.NumericField">[docs]</a>    <span class="k">class</span> <span class="nc">NumericField</span><span class="p">(</span><span class="n">InputField</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This represents a numeric field. It apears with an spin up/down button.</span>

<span class="sd">        The values of parameres are inherited from :py:class:`InputField`</span>

<span class="sd">        Additionally to standard parameters, the length parameter indicates the</span>
<span class="sd">        max number of digits (0-9 values).</span>

<span class="sd">        Example usage:</span>

<span class="sd">           .. code-block:: python</span>

<span class="sd">              # Declares an numeric form field, with max value of 99999, label</span>
<span class="sd">              # &quot;Port&quot;, that is required,</span>
<span class="sd">              # with tooltip &quot;Port (usually 443)&quot; and order 1</span>
<span class="sd">              num = gui.NumericField(length=5, label = _(&#39;Port&#39;),</span>
<span class="sd">                  defvalue = &#39;443&#39;, order = 1, tooltip = _(&#39;Port (usually 443)&#39;),</span>
<span class="sd">                  required = True)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">NUMERIC_TYPE</span><span class="p">)</span>

<div class="viewcode-block" id="gui.NumericField.num"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.NumericField.num">[docs]</a>        <span class="k">def</span> <span class="nf">num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Return value as integer</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="gui.PasswordField"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.PasswordField">[docs]</a>    <span class="k">class</span> <span class="nc">PasswordField</span><span class="p">(</span><span class="n">InputField</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This represents a password field. It appears with &quot;*&quot; at input, so the contents is not displayed</span>

<span class="sd">        The values of parameres are inherited from :py:class:`InputField`</span>

<span class="sd">        Additionally to standard parameters, the length parameter is a recommended one for this kind of field.</span>

<span class="sd">        Example usage:</span>

<span class="sd">           .. code-block:: python</span>

<span class="sd">              # Declares an text form field, with label &quot;Password&quot;,</span>
<span class="sd">              # tooltip &quot;Password of the user&quot;, that is required,</span>
<span class="sd">              # with max length of 32 chars and order = 2, and is</span>
<span class="sd">              # editable after creation.</span>
<span class="sd">              passw = gui.PasswordField(lenth=32, label = _(&#39;Password&#39;),</span>
<span class="sd">                  order = 4, tooltip = _(&#39;Password of the user&#39;),</span>
<span class="sd">                  required = True)</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">PASSWORD_TYPE</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="gui.HiddenField"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.HiddenField">[docs]</a>    <span class="k">class</span> <span class="nc">HiddenField</span><span class="p">(</span><span class="n">InputField</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This represents a hidden field. It is not displayed to the user. It use</span>
<span class="sd">        is for keeping info at form needed</span>
<span class="sd">        by module, but not editable by user (i.e., one service can keep info</span>
<span class="sd">        about the parent provider in hiddens)</span>

<span class="sd">        The values of parameres are inherited from :py:class:`InputField`</span>

<span class="sd">        These are almost the same as TextFields, but they do not get displayed</span>
<span class="sd">        for user interaction.</span>

<span class="sd">        Example usage:</span>

<span class="sd">           .. code-block:: python</span>

<span class="sd">              # Declares an empty hidden field</span>
<span class="sd">              hidden = gui.HiddenField()</span>


<span class="sd">           After that, at initGui method of module, we can store a value inside</span>
<span class="sd">           using setDefValue as shown here:</span>

<span class="sd">           .. code-block:: python</span>

<span class="sd">              def initGui(self):</span>
<span class="sd">                  # always set defValue using self, cause we only want to store</span>
<span class="sd">                  # value for current instance</span>
<span class="sd">                  self.hidden.setDefValue(self.parent().serialize())</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_isSerializable</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;serializable&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">HIDDEN_TYPE</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">isSerializable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isSerializable</span>
</div>
<div class="viewcode-block" id="gui.CheckBoxField"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.CheckBoxField">[docs]</a>    <span class="k">class</span> <span class="nc">CheckBoxField</span><span class="p">(</span><span class="n">InputField</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This represents a check box field, with values &quot;true&quot; and &quot;false&quot;</span>

<span class="sd">        The values of parameters are inherited from :py:class:`InputField`</span>

<span class="sd">        The valid values for this defvalue are: &quot;true&quot; and &quot;false&quot; (as strings)</span>

<span class="sd">        Example usage:</span>

<span class="sd">           .. code-block:: python</span>

<span class="sd">              # Declares an check box field, with label &quot;Use SSL&quot;, order 3,</span>
<span class="sd">              # tooltip &quot;If checked, will use a ssl connection&quot;, default value</span>
<span class="sd">              # unchecked (not included, so it&#39;s empty, so it&#39;s not true :-))</span>
<span class="sd">              ssl = gui.CheckBoxField(label = _(&#39;Use SSL&#39;), order = 3,</span>
<span class="sd">                  tooltip = _(&#39;If checked, will use a ssl connection&#39;))</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">CHECKBOX_TYPE</span><span class="p">)</span>

<div class="viewcode-block" id="gui.CheckBoxField.isTrue"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.CheckBoxField.isTrue">[docs]</a>        <span class="k">def</span> <span class="nf">isTrue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Checks that the value is true</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s">&#39;true&#39;</span>
</div></div>
<div class="viewcode-block" id="gui.ChoiceField"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.ChoiceField">[docs]</a>    <span class="k">class</span> <span class="nc">ChoiceField</span><span class="p">(</span><span class="n">InputField</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This represents a simple combo box with single selection.</span>

<span class="sd">        The values of parameters are inherited from :py:class:`InputField`</span>

<span class="sd">        ChoiceField needs a function to provide values inside it.</span>

<span class="sd">        * We specify the values via &quot;values&quot; option this way:</span>

<span class="sd">           Example:</span>

<span class="sd">           .. code-block:: python</span>

<span class="sd">              choices = gui.ChoiceField(label=&quot;choices&quot;, values = [ {&#39;id&#39;:&#39;1&#39;,</span>
<span class="sd">                  &#39;text&#39;:&#39;Text 1&#39;}, {&#39;id&#39;:&#39;xxx&#39;, &#39;text&#39;:&#39;Text 2&#39;}])</span>

<span class="sd">           You can specify a multi valuated field via id-values, or a</span>
<span class="sd">           single-valued field via id-value</span>

<span class="sd">        * We can override choice values at UserInterface derived class</span>
<span class="sd">          constructor or initGui using setValues</span>

<span class="sd">        There is an extra option available for this kind of field:</span>

<span class="sd">           fills: This options is a dictionary that contains this fields:</span>
<span class="sd">              * &#39;callbackName&#39; : Callback name for invocation via the specific</span>
<span class="sd">                 method xml-rpc. This name is a name we assign to this callback,</span>
<span class="sd">                 and is used to locate the method when callback is invoked from</span>
<span class="sd">                 admin interface.</span>
<span class="sd">              * &#39;function&#39; : Function to execute.</span>

<span class="sd">                 This funtion receives one parameter, that is a dictionary with</span>
<span class="sd">                 all parameters (that, in time, are fields names) that we have</span>
<span class="sd">                 requested.</span>

<span class="sd">                 The expected return value for this callback is an array of</span>
<span class="sd">                 dictionaries with fields and values to set, as</span>
<span class="sd">                 example show below shows.</span>
<span class="sd">              * &#39;parameters&#39; : Array of field names to pass back to server so</span>
<span class="sd">                 it can obtain the results.</span>

<span class="sd">                 Of course, this fields must be part of the module.</span>

<span class="sd">           Example:</span>

<span class="sd">            .. code-block:: python</span>

<span class="sd">               choice1 = gui.ChoiceField(label=&quot;Choice 1&quot;, values = ....,</span>
<span class="sd">                   fills = { &#39;target&#39;: &#39;choice2&#39;, &#39;callback&#39;: fncValues,</span>
<span class="sd">                       &#39;parameters&#39;: [&#39;choice1&#39;, &#39;name&#39;]}</span>
<span class="sd">                   )</span>
<span class="sd">               choice2 = ghui.ChoiceField(label=&quot;Choice 2&quot;)</span>

<span class="sd">            Here is a more detailed explanation, using the VC service module as</span>
<span class="sd">            sample.</span>

<span class="sd">            .. code-block:: python</span>

<span class="sd">               class VCHelpers(object):</span>
<span class="sd">                   # ...</span>
<span class="sd">                   # other stuff</span>
<span class="sd">                   # ...</span>
<span class="sd">                   @staticmethod</span>
<span class="sd">                   def getMachines(parameters):</span>
<span class="sd">                       # ...initialization and other stuff...</span>
<span class="sd">                       if parameters[&#39;resourcePool&#39;] != &#39;&#39;:</span>
<span class="sd">                           # ... do stuff ...</span>
<span class="sd">                       data = [ { &#39;name&#39; : &#39;machine&#39;, &#39;values&#39; : &#39;xxxxxx&#39; } ]</span>
<span class="sd">                       return data</span>

<span class="sd">               class ModuleVC(services.Service)</span>
<span class="sd">                  # ...</span>
<span class="sd">                  # stuff</span>
<span class="sd">                  # ...</span>
<span class="sd">                  resourcePool = gui.ChoiceField(</span>
<span class="sd">                      label=_(&quot;Resource Pool&quot;), rdonly = False, order = 5,</span>
<span class="sd">                      fills = {</span>
<span class="sd">                          &#39;callbackName&#39; : &#39;vcFillMachinesFromResource&#39;,</span>
<span class="sd">                          &#39;function&#39; : VCHelpers.getMachines,</span>
<span class="sd">                          &#39;parameters&#39; : [&#39;vc&#39;, &#39;ev&#39;, &#39;resourcePool&#39;]</span>
<span class="sd">                      },</span>
<span class="sd">                      tooltip = _(&#39;Resource Pool containing base machine&#39;),</span>
<span class="sd">                      required = True</span>
<span class="sd">                  )</span>

<span class="sd">                  machine = gui.ChoiceField(label = _(&quot;Base Machine&quot;), order = 6,</span>
<span class="sd">                      tooltip = _(&#39;Base machine for this service&#39;), required = True )</span>

<span class="sd">                  vc = gui.HiddenField()</span>
<span class="sd">                  ev = gui.HiddenField() # ....</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;values&#39;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="s">&#39;fills&#39;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
                <span class="c"># Save fnc to register as callback</span>
                <span class="n">fills</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;fills&#39;</span><span class="p">]</span>
                <span class="n">fnc</span> <span class="o">=</span> <span class="n">fills</span><span class="p">[</span><span class="s">&#39;function&#39;</span><span class="p">]</span>
                <span class="n">fills</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;function&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;fills&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fills</span>
                <span class="n">gui</span><span class="o">.</span><span class="n">callbacks</span><span class="p">[</span><span class="n">fills</span><span class="p">[</span><span class="s">&#39;callbackName&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">fnc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">CHOICE_TYPE</span><span class="p">)</span>

<div class="viewcode-block" id="gui.ChoiceField.setValues"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.ChoiceField.setValues">[docs]</a>        <span class="k">def</span> <span class="nf">setValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Set the values for this choice field</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
</div></div>
<div class="viewcode-block" id="gui.MultiChoiceField"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.MultiChoiceField">[docs]</a>    <span class="k">class</span> <span class="nc">MultiChoiceField</span><span class="p">(</span><span class="n">InputField</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Multichoices are list of items that are multi-selectable.</span>

<span class="sd">        There is a new parameter here, not covered by InputField:</span>
<span class="sd">            * &#39;rows&#39; to tell gui how many rows to display (the length of the</span>
<span class="sd">              displayable list)</span>

<span class="sd">        &quot;defvalue&quot;  is expresed as a comma separated list of ids</span>

<span class="sd">        This class do not have callback support, as ChoiceField does.</span>

<span class="sd">        The values is an array of dictionaries, in the form [ { &#39;id&#39; : &#39;a&#39;,</span>
<span class="sd">        &#39;text&#39;: b }, ... ]</span>

<span class="sd">        Example usage:</span>

<span class="sd">           .. code-block:: python</span>

<span class="sd">              # Declares a multiple choices field, with label &quot;Datastores&quot;, that</span>
<span class="sd">              is editable, with 5 rows for displaying</span>
<span class="sd">              # data at most in user interface, 8th in order, that is required</span>
<span class="sd">              and has tooltip &quot;Datastores where to put incrementals&quot;,</span>
<span class="sd">              # this field is required and has 2 selectable items: &quot;datastore0&quot;</span>
<span class="sd">              with id &quot;0&quot; and &quot;datastore1&quot; with id &quot;1&quot;</span>
<span class="sd">              datastores =  gui.MultiChoiceField(label = _(&quot;Datastores&quot;),</span>
<span class="sd">                  rdonly = False, rows = 5, order = 8,</span>
<span class="sd">                  tooltip = _(&#39;Datastores where to put incrementals&#39;),</span>
<span class="sd">                  required = True,</span>
<span class="sd">                  values = [ {&#39;id&#39;: &#39;0&#39;, &#39;text&#39;: &#39;datastore0&#39; },</span>
<span class="sd">                      {&#39;id&#39;: &#39;1&#39;, &#39;text&#39;: &#39;datastore1&#39; } ]</span>
<span class="sd">                  )</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;values&#39;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;rows&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;rows&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">MULTI_CHOICE_TYPE</span><span class="p">)</span>

<div class="viewcode-block" id="gui.MultiChoiceField.setValues"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.MultiChoiceField.setValues">[docs]</a>        <span class="k">def</span> <span class="nf">setValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Set the values for this multi choice field</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
</div></div>
<div class="viewcode-block" id="gui.EditableList"><a class="viewcode-back" href="../../../../api/modules/FormFields.html#uds.core.ui.UserInterface.gui.EditableList">[docs]</a>    <span class="k">class</span> <span class="nc">EditableList</span><span class="p">(</span><span class="n">InputField</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Editables list are lists of editable elements (i.e., a list of IPs, macs,</span>
<span class="sd">        names, etcc) treated as simple strings with no id</span>

<span class="sd">        The struct used to pass values is an array of strings, i.e. [&#39;1&#39;, &#39;2&#39;,</span>
<span class="sd">        &#39;test&#39;, &#39;bebito&#39;, ...]</span>

<span class="sd">        This list don&#39;t have &quot;selected&quot; items, so its defvalue field is simply</span>
<span class="sd">        ignored.</span>

<span class="sd">        We only nee to pass in &quot;label&quot; and, maybe, &quot;values&quot; to set default</span>
<span class="sd">        content for the list.</span>

<span class="sd">        Keep in mind that this is an user editable list, so the user can insert</span>
<span class="sd">        values and/or import values from files, so</span>
<span class="sd">        by default it will probably have no content at all.</span>

<span class="sd">        Example usage:</span>

<span class="sd">           .. code-block:: python</span>

<span class="sd">              #</span>
<span class="sd">              ipList = gui.EditableList(label=_(&#39;List of IPS&#39;))</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c"># : Constant for separating values at &quot;value&quot; method</span>
        <span class="n">SEPARATOR</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\001</span><span class="s">&#39;</span>

        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">convertToList</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;values&#39;</span><span class="p">,</span> <span class="p">[]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">EDITABLE_LIST</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_setValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            So we can override value setting at descendants</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_setValue</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s">&#39;values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">convertToList</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

</div></div>
<span class="k">class</span> <span class="nc">UserInterfaceType</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Metaclass definition for moving the user interface descriptions to a usable</span>
<span class="sd">    better place</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">classname</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">classDict</span><span class="p">):</span>
        <span class="n">newClassDict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">_gui</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c"># We will keep a reference to gui elements also at _gui so we can access them easily</span>
        <span class="k">for</span> <span class="n">attrName</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">classDict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="p">):</span>
                <span class="n">_gui</span><span class="p">[</span><span class="n">attrName</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr</span>
            <span class="n">newClassDict</span><span class="p">[</span><span class="n">attrName</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr</span>
        <span class="n">newClassDict</span><span class="p">[</span><span class="s">&#39;_gui&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_gui</span>
        <span class="k">return</span> <span class="nb">type</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">classname</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">newClassDict</span><span class="p">)</span>


<div class="viewcode-block" id="UserInterface"><a class="viewcode-back" href="../../../../api/modules/BaseModule.html#uds.core.ui.UserInterface.UserInterface">[docs]</a><span class="k">class</span> <span class="nc">UserInterface</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class provides the management for gui descriptions (user forms)</span>

<span class="sd">    Once a class is derived from this one, that class can contain Field</span>
<span class="sd">    Descriptions,</span>
<span class="sd">    that will be managed correctly.</span>

<span class="sd">    By default, the values passed to this class constructor are used to fill</span>
<span class="sd">    the gui form fields values.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">UserInterfaceType</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">copy</span>
        <span class="c"># : If there is an array of elements to initialize, simply try to store values on form fields</span>
        <span class="c"># Generate a deep copy of inherited Gui, so each User Interface instance has its own &quot;field&quot; set, and do not share the &quot;fielset&quot; with others, what can be really dangerous</span>
        <span class="c"># Till now, nothing bad happened cause there where being used &quot;serialized&quot;, but this do not have to be this way</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="p">)</span>  <span class="c"># Ensure &quot;gui&quot; is our own instance, deep copied from base</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>  <span class="c"># And refresg references to them</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

<div class="viewcode-block" id="UserInterface.initGui"><a class="viewcode-back" href="../../../../api/modules/BaseModule.html#uds.core.ui.UserInterface.UserInterface.initGui">[docs]</a>    <span class="k">def</span> <span class="nf">initGui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This method gives the oportunity to initialize gui fields before they</span>
<span class="sd">        are send to administartion client.</span>
<span class="sd">        We need this because at initialization time we probably don&#39;t have the</span>
<span class="sd">        data for gui.</span>

<span class="sd">        :note: This method is used as a &quot;trick&quot; to allow to modify default form</span>
<span class="sd">               data for services. Services are child of Service Providers, and</span>
<span class="sd">               will probably need data from Provider to fill initial form data.</span>
<span class="sd">               The rest of modules will not use this, and this only will be used</span>
<span class="sd">               when the user requests a new service or wants to modify existing</span>
<span class="sd">               one.</span>
<span class="sd">        :note: There is a drawback of this, and it is that there is that this</span>
<span class="sd">               method will modify service default data. It will run fast (probably),</span>
<span class="sd">               but may happen that two services of same type are requested at same</span>
<span class="sd">               time, and returned data will be probable a nonsense. We will take care</span>
<span class="sd">               of this posibility in a near version...</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="UserInterface.valuesDict"><a class="viewcode-back" href="../../../../api/modules/BaseModule.html#uds.core.ui.UserInterface.UserInterface.valuesDict">[docs]</a>    <span class="k">def</span> <span class="nf">valuesDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns own data needed for user interaction as a dict of key-names -&gt;</span>
<span class="sd">        values. The values returned must be strings.</span>

<span class="sd">        Example:</span>
<span class="sd">            we have 2 text field, first named &quot;host&quot; and second named &quot;port&quot;,</span>
<span class="sd">            we can do something like this:</span>

<span class="sd">            .. code-block:: python</span>

<span class="sd">               return { &#39;host&#39; : self.host, &#39;port&#39; : self.port }</span>

<span class="sd">            (Just the reverse of :py:meth:`.__init__`, __init__ receives this</span>
<span class="sd">            dict, valuesDict must return the dict)</span>

<span class="sd">        Names must coincide with fields declared.</span>

<span class="sd">        Returns:</span>
<span class="sd">             Dictionary, associated with declared fields.</span>
<span class="sd">             Default implementation returns the values stored at the gui form</span>
<span class="sd">             fields declared.</span>

<span class="sd">        :note: By default, the provided method returns the correct values</span>
<span class="sd">               extracted from form fields</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">isType</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">EDITABLE_LIST</span><span class="p">):</span>
                <span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">convertToList</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">v</span><span class="o">.</span><span class="n">isType</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">MULTI_CHOICE_TYPE</span><span class="p">):</span>
                <span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">convertToChoices</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">value</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Dict: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dic</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">dic</span>
</div>
<div class="viewcode-block" id="UserInterface.serializeForm"><a class="viewcode-back" href="../../../../api/modules/BaseModule.html#uds.core.ui.UserInterface.UserInterface.serializeForm">[docs]</a>    <span class="k">def</span> <span class="nf">serializeForm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        All values stored at form fields are serialized and returned as a single</span>
<span class="sd">        string</span>
<span class="sd">        Separating char is</span>

<span class="sd">        The returned string is zipped and then converted to base 64</span>

<span class="sd">        Note: Hidens are not serialized, they are ignored</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;serializing Key: {0}/{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">isType</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">HIDDEN_TYPE</span><span class="p">)</span> <span class="ow">and</span> <span class="n">v</span><span class="o">.</span><span class="n">isSerializable</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Field {0} is not serializable&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">isType</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">EDITABLE_LIST</span><span class="p">)</span> <span class="ow">or</span> <span class="n">v</span><span class="o">.</span><span class="n">isType</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">MULTI_CHOICE_TYPE</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Serializing value {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
                <span class="n">val</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\001</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">TRUE</span>
            <span class="k">elif</span> <span class="n">val</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">FALSE</span>
            <span class="n">arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\003</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&#39;</span><span class="se">\002</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;zip&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="UserInterface.unserializeForm"><a class="viewcode-back" href="../../../../api/modules/BaseModule.html#uds.core.ui.UserInterface.UserInterface.unserializeForm">[docs]</a>    <span class="k">def</span> <span class="nf">unserializeForm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This method unserializes the values previously obtained using</span>
<span class="sd">        :py:meth:`serializeForm`, and stores</span>
<span class="sd">        the valid values form form fileds inside its corresponding field</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">values</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>  <span class="c"># Has nothing</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c"># Set all values to defaults ones</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">():</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">isType</span><span class="p">(</span><span class="n">gui</span><span class="o">.</span><span class="n">InputField</span><span class="o">.</span><span class="n">HIDDEN_TYPE</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">isSerializable</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                    <span class="c"># logger.debug(&#39;Field {0} is not unserializable&#39;.format(k))</span>
                    <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">defValue</span>

            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;zip&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">values</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>  <span class="c"># Has nothing</span>
                <span class="k">return</span>

            <span class="k">for</span> <span class="n">txt</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\002</span><span class="s">&#39;</span><span class="p">):</span>
                <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\003</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\001</span><span class="s">&#39;</span><span class="p">:</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">v</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_gui</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">val</span>
                <span class="c"># logger.debug(&#39;Value for {0}:{1}&#39;.format(k, val))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c"># Values can contain invalid characters, so we log every single char</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Invalid serialization data on {0} {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;hex&#39;</span><span class="p">)))</span>
</div>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="UserInterface.guiDescription"><a class="viewcode-back" href="../../../../api/modules/BaseModule.html#uds.core.ui.UserInterface.UserInterface.guiDescription">[docs]</a>    <span class="k">def</span> <span class="nf">guiDescription</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This simple method generates the gui description needed by the</span>
<span class="sd">        administration client, so it can</span>
<span class="sd">        represent it at user interface and manage it.</span>

<span class="sd">        Args:</span>
<span class="sd">            object: If not none, object that will get its &quot;initGui&quot; invoked</span>
<span class="sd">                    This will only happen (not to be None) in Services.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Active languaje for gui translation: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">get_language</span><span class="p">()))</span>
        <span class="n">gui</span> <span class="o">=</span> <span class="n">cls</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">initGui</span><span class="p">()</span>  <span class="c"># We give the &quot;oportunity&quot; to fill necesary gui data before providing it to client</span>
            <span class="n">gui</span> <span class="o">=</span> <span class="n">obj</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">gui</span><span class="o">.</span><span class="n">_gui</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;{0} ### {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s">&#39;gui&#39;</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">guiDescription</span><span class="p">(),</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">})</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Gui Description: {0} -- {1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">res</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">res</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">UDS 1.0 documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../core.html" >uds.core</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Virtual Cable S.L.U..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>